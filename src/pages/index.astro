---
import BaseLayout from '../layouts/BaseLayout.astro';
import OptimizedImage from '../components/OptimizedImage.astro';
import Hero from '../components/Hero.astro';
import CategoryCard from '../components/CategoryCard.astro';
import { getCollection } from 'astro:content';
import { SITE, CATEGORIES } from '../config';
import { getPublishedPosts, getPostSlug } from '../utils/blog';

// Get latest blog posts
const posts = await getPublishedPosts();
const latestPosts = posts.slice(0, 3);

// Create a set of published slugs for efficient lookup
const publishedSlugs = new Set(posts.map(post => getPostSlug(post)));

// Filter categories to only show links that are actually published
const displayCategories = CATEGORIES.map(category => ({
  ...category,
  links: category.links.filter(link => {
    // Determine the slug from the href (e.g., '/post-slug/' -> 'post-slug')
    const slug = link.href.replace(/^\//, '').replace(/\/$/, '');
    return publishedSlugs.has(slug);
  })
})).filter(category => category.links.length > 0);
---

<BaseLayout 
  title="Turn Boring Work Hours Into Your Next Breakthrough" 
  description="Stop doom-scrolling. Use your 9-to-5 downtime to master AI skills, learn 3D printing, and research your next hobby. The ultimate guide to productive procrastination."
>
  <Hero
    title="Turn Boring Work Hours Into Your Next Breakthrough"
    description="Stuck at your desk? Master AI skills, start a 3D printing hobby, or find your perfect camera. We help you make the most of your 9-to-5 downtime."
    ctaText="See 25 Productive Ideas ‚Üí"
    ctaHref="/productive-things-bored-at-work/"
  />

  <!-- Latest Articles (moved up) -->
  {latestPosts.length > 0 && (
    <section class="py-16">
      <div class="max-w-6xl mx-auto px-4">
        <h2 class="text-2xl md:text-3xl font-bold mb-2">Latest Articles</h2>
        <p class="text-text-light mb-8">Fresh guides and tutorials to help you make the most of your work hours.</p>
        <div class="grid md:grid-cols-3 gap-6">
          {latestPosts.map(post => (
            <article class="bg-white rounded-xl overflow-hidden shadow-sm border border-primary/5 hover:shadow-md transition-shadow">
              {post.data.image && (
                <OptimizedImage
                  src={post.data.image.replace('/images/', '/images/thumbnails/')}
                  alt={post.data.title}
                  class="w-full aspect-square object-cover"
                />
              )}
              <div class="p-5">
                <h3 class="font-bold mb-2 line-clamp-2">
                  <a href={`/${getPostSlug(post)}/`} class="hover:text-accent transition-colors text-primary">
                    {post.data.title}
                  </a>
                </h3>
                <p class="text-text-light text-sm line-clamp-2 mb-3">
                  {post.data.description}
                </p>
                <a href={`/${getPostSlug(post)}/`} class="text-accent text-sm font-medium hover:underline">
                  Read more ‚Üí
                </a>
              </div>
            </article>
          ))}
        </div>
        <div class="text-center mt-8">
          <a href="/blog/" class="btn-secondary">
            View All Articles
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- Featured Article Spotlight -->
  <section class="py-20 bg-background-alt relative overflow-hidden">
    <div class="max-w-5xl mx-auto px-4 relative z-10">
      <div class="bg-white rounded-[2rem] p-8 md:p-12 border border-primary/5 shadow-2xl shadow-primary/5 flex flex-col md:flex-row items-center gap-10">
        <div class="flex-1">
          <div class="flex items-center gap-2 mb-6 text-accent">
            <span class="text-xs font-bold uppercase tracking-[0.2em]">Quick Start Guide</span>
          </div>
          <h2 class="text-3xl md:text-4xl font-bold mb-6 leading-tight">
            25 Productive Things to Do When Bored at Work
          </h2>
          <p class="text-lg text-text-light mb-8 leading-relaxed">
            Stop scrolling social media. Start building skills that actually move the needle. From office-friendly hobbies to essential career boosts.
          </p>
          <div class="flex flex-wrap gap-4 mb-8">
            <span class="bg-primary/5 text-primary text-xs font-medium px-3 py-1.5 rounded-lg border border-primary/10 flex items-center gap-2">
              <span class="w-2 h-2 rounded-full bg-accent animate-pulse"></span>
              Low Effort
            </span>
            <span class="bg-primary/5 text-primary text-xs font-medium px-3 py-1.5 rounded-lg border border-primary/10">
              High Impact
            </span>
            <span class="bg-primary/5 text-primary text-xs font-medium px-3 py-1.5 rounded-lg border border-primary/10">
              100% Free
            </span>
          </div>
          <a href="/productive-things-bored-at-work/" class="btn-primary">
            Read the Full Guide <span class="ml-1">‚Üí</span>
          </a>
        </div>
        <div class="w-full md:w-1/3 grid grid-cols-2 gap-4">
          <div class="bg-background p-4 rounded-xl border border-primary/5 text-center">
            <div class="text-2xl mb-2">‚ö°</div>
            <p class="text-[10px] font-bold uppercase text-text-light tracking-tighter leading-none">AI Skills</p>
          </div>
          <div class="bg-background p-4 rounded-xl border border-primary/5 text-center translate-y-4">
            <div class="text-2xl mb-2">üé®</div>
            <p class="text-[10px] font-bold uppercase text-text-light tracking-tighter leading-none">Creative</p>
          </div>
          <div class="bg-background p-4 rounded-xl border border-primary/5 text-center -translate-y-4">
            <div class="text-2xl mb-2">üïµÔ∏è</div>
            <p class="text-[10px] font-bold uppercase text-text-light tracking-tighter leading-none">Stealth</p>
          </div>
          <div class="bg-background p-4 rounded-xl border border-primary/5 text-center">
            <div class="text-2xl mb-2">üì∏</div>
            <p class="text-[10px] font-bold uppercase text-text-light tracking-tighter leading-none">Media</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Content Categories -->
  <section class="py-16">
    <div class="max-w-6xl mx-auto px-4">
      <div class="grid md:grid-cols-3 gap-8">
        {displayCategories.map(category => (
          <CategoryCard {...category} />
        ))}
      </div>
    </div>
  </section>

  <!-- Why Section -->
  <section class="py-24 bg-primary text-white relative overflow-hidden">
    <div class="absolute inset-0 opacity-10 bg-[radial-gradient(#3b82f6_1px,transparent_1px)] [background-size:24px_24px]"></div>
    <div class="max-w-4xl mx-auto px-4 text-center relative z-10">
      <h2 class="text-3xl md:text-4xl font-bold mb-12 text-white">Why "Waste" Your Downtime?</h2>
      <div class="grid md:grid-cols-3 gap-12 mb-12">
        <div class="p-4">
          <div class="text-5xl md:text-6xl font-bold text-accent mb-4">28%</div>
          <p class="text-white/60 text-sm uppercase tracking-wider font-semibold">of the workday is spent on distractions</p>
        </div>
        <div class="p-4 border-y md:border-y-0 md:border-x border-white/10">
          <div class="text-5xl md:text-6xl font-bold text-accent mb-4">5+ hrs</div>
          <p class="text-white/60 text-sm uppercase tracking-wider font-semibold">typical weekly office downtime</p>
        </div>
        <div class="p-4">
          <div class="text-5xl md:text-6xl font-bold text-accent mb-4">$0</div>
          <p class="text-white/60 text-sm uppercase tracking-wider font-semibold">cost to start most hobbies we cover</p>
        </div>
      </div>
      <p class="text-white/70 max-w-2xl mx-auto text-lg leading-relaxed">
        The pros who use their downtime to level up will always have a massive edge. If you're bored at home-office anyway, why not master a new skill or hobby while getting paid?
      </p>
    </div>
  </section>

  <!-- Learning Paths Section (moved down) -->
  <section class="py-24 bg-background relative overflow-hidden">
    <div class="max-w-6xl mx-auto px-4 relative z-10">
      <div class="flex flex-col md:flex-row items-end justify-between mb-12 gap-6">
        <div class="max-w-2xl">
          <div class="inline-block bg-primary/5 text-primary text-xs font-bold uppercase tracking-widest px-3 py-1 rounded-full mb-4">
            Structured Growth
          </div>
          <h2 class="text-3xl md:text-5xl font-bold mb-4">Stealth Learning Paths</h2>
          <p class="text-xl text-text-light">
            Follow a structured, professional-looking roadmap to master new skills during your downtime.
          </p>
        </div>
        <a href="/learning-paths/" class="btn-secondary group whitespace-nowrap">
          View All Paths <span class="inline-block transition-transform group-hover:translate-x-1">‚Üí</span>
        </a>
      </div>
      
      <div class="grid md:grid-cols-2 gap-8">
        <div class="bg-background-alt p-8 rounded-3xl border border-primary/5 hover:shadow-xl transition-all group relative overflow-hidden flex flex-col justify-between">
          <div class="absolute -right-10 -bottom-10 w-40 h-40 bg-accent/5 rounded-full blur-2xl group-hover:bg-accent/10 transition-colors"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-4 mb-4">
              <div class="w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-2xl">‚ö°</div>
              <div class="h-px flex-grow bg-primary/10"></div>
              <span class="text-[10px] font-bold text-accent uppercase tracking-tighter">Level 1-5</span>
            </div>
            <h3 class="text-2xl font-bold mb-3">AI Mastery</h3>
            <p class="text-text-light mb-6">From writing your first prompt to automating your daily tasks with custom AI workflows.</p>
          </div>
          <a href="/learning-paths/ai-mastery/" class="relative z-10 inline-flex items-center text-accent font-bold group/link">
            Start Learning Path 
            <span class="ml-2 transition-transform group-hover/link:translate-x-1">‚Üí</span>
          </a>
        </div>
        
        <div class="bg-background-alt p-8 rounded-3xl border border-primary/5 hover:shadow-xl transition-all group relative overflow-hidden flex flex-col justify-between">
          <div class="absolute -right-10 -bottom-10 w-40 h-40 bg-accent-alt/5 rounded-full blur-2xl group-hover:bg-accent-alt/10 transition-colors"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-4 mb-4">
              <div class="w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-2xl">üñ®Ô∏è</div>
              <div class="h-px flex-grow bg-primary/10"></div>
              <span class="text-[10px] font-bold text-accent-alt uppercase tracking-tighter">Side Quest</span>
            </div>
            <h3 class="text-2xl font-bold mb-3">3D Printing Startup</h3>
            <p class="text-text-light mb-6">Turn your desk into a production line. Learn design, slicing, and how to sell your first prints.</p>
          </div>
          <a href="/learning-paths/3d-printing-startup/" class="relative z-10 inline-flex items-center text-accent-alt font-bold group/link">
            Start Learning Path 
            <span class="ml-2 transition-transform group-hover/link:translate-x-1">‚Üí</span>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section class="py-16 bg-background-alt">
    <div class="max-w-3xl mx-auto px-4">
      <h2 class="text-2xl md:text-3xl font-bold mb-4">About {SITE.title}</h2>
      <p class="text-text-light mb-4 leading-relaxed">
        We've all been there ‚Äî staring at the clock, waiting for 5pm, mindlessly scrolling through the same websites.
        But what if you could turn those boring hours into something that actually moves your career forward?
      </p>
      <p class="text-text-light mb-4 leading-relaxed">
        {SITE.title} is your guide to productive procrastination. We find the best free courses,
        creative hobbies, and tech tutorials you can dive into during work downtime. No fluff, no filler ‚Äî just practical
        resources that help you learn real skills and master new crafts while you're getting paid.
      </p>
      <p class="text-text-light leading-relaxed">
        <strong class="text-primary">Our focus:</strong> Technical skills, creative hobbies, and smart gear research. 
        The kind of stuff that makes you more capable, more creative, and just less bored.
      </p>
    </div>
  </section>

  <!-- Final CTA -->
  <section class="py-16 bg-gradient-to-r from-accent to-accent-hover text-white">
    <div class="max-w-2xl mx-auto px-4 text-center">
      <h2 class="text-2xl md:text-3xl font-bold mb-4 text-white">Ready to Stop Being Bored?</h2>
      <p class="text-white/90 mb-6">
        Start with our most popular guide and discover 25 productive ways to use your work downtime.
      </p>
      <a href="/productive-things-bored-at-work/" class="inline-block bg-white text-accent px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
        Get Started ‚Üí
      </a>
    </div>
  </section>
</BaseLayout>
