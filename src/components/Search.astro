---
// CSS is loaded dynamically below
---

<link rel="stylesheet" href="/pagefind/pagefind-ui.css" />
<div id="search" class="ml-4 relative"></div>

<script is:inline>
  async function initPagefind() {
    // Load PagefindUI from the generated pagefind folder
    const pagefindPath = '/pagefind/pagefind-ui.js';
    const { PagefindUI } = await import(/* @vite-ignore */ pagefindPath);

    new PagefindUI({
      element: "#search",
      showSubResults: true,
      showImages: false,
      translations: {
        placeholder: "Search articles...",
        zero_results: "No articles found for [SEARCH_TERM]"
      }
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initPagefind);
  } else {
    initPagefind();
  }
</script>

<style is:global>
  /* Customizing Pagefind UI to match site theme */
  :root {
    --pagefind-ui-scale: 0.8;
    --pagefind-ui-primary: var(--color-accent);
    --pagefind-ui-text: var(--color-text);
    --pagefind-ui-background: white;
    --pagefind-ui-border: var(--color-primary-light);
    --pagefind-ui-tag: var(--color-primary-light);
    --pagefind-ui-border-width: 1px;
    --pagefind-ui-border-radius: 8px;
    --pagefind-ui-image-border-radius: 8px;
    --pagefind-ui-image-box-ratio: 3 / 2;
    --pagefind-ui-font: var(--font-body);
  }

  /* Dark mode overrides if needed, or specific component styles */
  .pagefind-ui__result-title {
    font-family: var(--font-heading);
    font-weight: 700;
  }
  
  .pagefind-ui__search-input {
    background-color: rgba(255, 255, 255, 0.1) !important;
    color: white !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
  }
  
  .pagefind-ui__search-input::placeholder {
    color: rgba(255, 255, 255, 0.6) !important;
  }

  /* Results dropdown styling */
  .pagefind-ui__drawer {
    background: white !important;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    border-radius: 0.5rem;
    margin-top: 0.5rem;
    position: absolute;
    right: 0;
    width: 300px; /* Or wider if needed */
    z-index: 100;
    max-height: 80vh;
    overflow-y: auto;
  }

  @media (max-width: 768px) {
    .pagefind-ui__drawer {
      position: fixed;
      top: 70px;
      left: 10px;
      right: 10px;
      width: auto;
    }
  }
</style>
